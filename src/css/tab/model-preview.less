/*
 * Copyright (C) 2025 Jukka Svahn
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/**
 * Model preview tab.
 *
 * [1] Negates the current surrounding spacing.
 * [2] Default styles use important.
 */
:root #tab_modelpreview_xd_interface {
  /**
   * Filter toolbar.
   */
  #cp_modelpreview_xd_control_row,
  #em_modelpreview_xd_control_row,
  #hn_modelpreview_xd_control_row,
  #lo_modelpreview_xd_control_row {
    border-bottom: 1px solid var(--input-border-color);
    padding: var(--padding-m);
    margin: -16px -16px 0 -16px; // [1]
    width: calc(100% + 32px);
  }

  #cp_modelpreview_xd_filter_text,
  #em_modelpreview_xd_filter_text,
  #hn_modelpreview_xd_filter_text,
  #lo_modelpreview_xd_filter_text {
    max-width: 30%;

    textarea {
      resize: none;
      scrollbar-width: none;
    }
  }

  #cp_modelpreview_xd_flexcolumn_row,
  #em_modelpreview_xd_flexcolumn_row,
  #hn_modelpreview_xd_flexcolumn_row,
  #lo_modelpreview_xd_flexcolumn_row {
    display: flex;
    flex-direction: row;
    gap: var(--margin-xl) !important; // [2]
    justify-content: space-between;
    position: static;
  }

  #cp_modelpreview_xd_html_row,
  #em_modelpreview_xd_html_row,
  #hn_modelpreview_xd_html_row,
  #lo_modelpreview_xd_html_row {
    flex: 1;
    overflow: visible;
  }

  #cp_modelpreview_xd_markdown_div,
  #em_modelpreview_xd_markdown_div,
  #hn_modelpreview_xd_markdown_div,
  #lo_modelpreview_xd_markdown_div {
    flex-grow: 2;
    max-width: 120ch;
  }

  #cp_modelpreview_xd_html_div,
  #em_modelpreview_xd_html_div,
  #hn_modelpreview_xd_html_div,
  #lo_modelpreview_xd_html_div {
    flex-grow: 1;
    order: 2;

    .img-container-set {
      align-content: center;
      align-items: stretch;
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: var(--margin-s);
      justify-content: end;
      margin: 0;
      max-height: none;
      max-width: 100%;
      overflow: visible;
      width: auto;

      .img-container {
        align-items: flex-end;
        aspect-ratio: 4 / 6;
        box-sizing: border-box;
        margin: 0;
        background: var(--image-bg-color);
        border: 1px solid var(--image-border-color);
        border-radius: var(--border-radius-m);
        box-shadow: none;
        color: var(--image-text-color);
        cursor: pointer;
        display: flex;
        flex-direction: row-reverse;
        flex-wrap: wrap;
        height: auto;
        overflow: hidden;
        padding: var(--padding-s);
        position: relative;
        width: var(--card-size);

        &::before {
          background: linear-gradient(360deg, var(--image-mask-bg-color), transparent 50%);
          bottom: 0;
          content: "";
          display: block;
          left: 0;
          opacity: 0;
          pointer-events: none;
          position: absolute;
          right: 0;
          top: 0;
          transition: opacity 0.25s;
          z-index: 2;
        }

        &:hover {
          &::before {
            opacity: 0.5;
          }
        }

        img {
          cursor: zoom-in;
          display: block;
          height: 100%;
          left: 0;
          object-fit: cover;
          object-position: center;
          position: absolute;
          top: 0;
          width: 100%;
          z-index: 1;
        }

        .img-meta-ico {
          z-index: 2;
          background: var(--image-mask-bg-color);
          color: var(--image-text-color);
          position: absolute;
          bottom: var(--padding-s);
          right: var(--padding-s);
          left: auto;
          top: auto;
          padding: var(--padding-xs);
          backdrop-filter: var(--image-mask-backdrop-filter);
          border-radius: var(--border-radius-xm);
          transition: box-shadow 0.25s;

          &:hover {
            box-shadow: 0 0 var(--padding-xxs) var(--image-mask-bg-color);
          }
        }
      }
    }
  }

  .footer-tags {
    border: 0;
    color: inherit;
    font: inherit;
    opacity: 1;
  }
}
